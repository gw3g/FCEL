#include <math.h>
/*
 * cosmic ray flux(es)
 *
 *--------------------------------------------------------------------*/

extern double g; // spectral index

double phiN(double Ep) { // units? [GeV.m^2.s.sr]^-1
  return pow(Ep,-g);
}

double phi_knee(double Ep) { // Thunman 1996
  if (Ep<5e6) return 1.7/pow(Ep,2.7);
  else return 174./pow(Ep,3.);
}

double phi_H3a(double Ep) { // Goncalves 2017
  double I0  = 1.15, g1  = 1.65, g2  = 2.4, Ek  = 1.2e6, eps = 3.0;
  return I0*pow(Ep,-1.-g1)*pow( 1. + pow(Ep/Ek,eps), (g1-g2)/eps );
}

/*--------------------------------------------------------------------*/

#define THOUSAND 1000
typedef struct { double Ep; double phi; } grid; 
grid GSF_data[THOUSAND] = { // CR: proton composition
  {3.,395.1},
  {3.077,376.3},
  {3.156,358.3},
  {3.237,341.1},
  {3.32,324.5},
  {3.405,308.7},
  {3.493,293.5},
  {3.583,278.9},
  {3.675,265.},
  {3.769,251.6},
  {3.866,238.9},
  {3.965,226.7},
  {4.067,215.},
  {4.171,203.8},
  {4.278,193.1},
  {4.388,182.9},
  {4.501,173.2},
  {4.616,163.9},
  {4.735,155.},
  {4.857,146.6},
  {4.981,138.5},
  {5.109,130.9},
  {5.24,123.6},
  {5.375,116.7},
  {5.513,110.1},
  {5.655,103.9},
  {5.8,97.99},
  {5.949,92.38},
  {6.101,87.06},
  {6.258,82.02},
  {6.419,77.24},
  {6.584,72.72},
  {6.753,68.44},
  {6.926,64.4},
  {7.104,60.57},
  {7.286,56.96},
  {7.473,53.55},
  {7.665,50.32},
  {7.862,47.28},
  {8.064,44.41},
  {8.271,41.7},
  {8.483,39.15},
  {8.701,36.74},
  {8.925,34.47},
  {9.154,32.34},
  {9.389,30.33},
  {9.63,28.44},
  {9.877,26.66},
  {10.13,24.98},
  {10.39,23.41},
  {10.66,21.93},
  {10.93,20.54},
  {11.21,19.23},
  {11.5,18.01},
  {11.8,16.86},
  {12.1,15.77},
  {12.41,14.76},
  {12.73,13.81},
  {13.05,12.92},
  {13.39,12.08},
  {13.73,11.29},
  {14.09,10.56},
  {14.45,9.869},
  {14.82,9.224},
  {15.2,8.619},
  {15.59,8.053},
  {15.99,7.523},
  {16.4,7.027},
  {16.82,6.563},
  {17.25,6.128},
  {17.7,5.722},
  {18.15,5.342},
  {18.62,4.987},
  {19.1,4.654},
  {19.59,4.344},
  {20.09,4.053},
  {20.6,3.782},
  {21.13,3.529},
  {21.68,3.292},
  {22.23,3.071},
  {22.8,2.864},
  {23.39,2.671},
  {23.99,2.491},
  {24.61,2.323},
  {25.24,2.166},
  {25.89,2.02},
  {26.55,1.883},
  {27.23,1.755},
  {27.93,1.636},
  {28.65,1.525},
  {29.38,1.422},
  {30.14,1.325},
  {30.91,1.235},
  {31.71,1.151},
  {32.52,1.073},
  {33.36,0.9996},
  {34.21,0.9315},
  {35.09,0.868},
  {35.99,0.8088},
  {36.92,0.7536},
  {37.86,0.7021},
  {38.84,0.6542},
  {39.83,0.6094},
  {40.86,0.5678},
  {41.91,0.5289},
  {42.98,0.4927},
  {44.08,0.459},
  {45.22,0.4276},
  {46.38,0.3983},
  {47.57,0.371},
  {48.79,0.3455},
  {50.04,0.3218},
  {51.33,0.2997},
  {52.65,0.2792},
  {54.,0.26},
  {55.38,0.2421},
  {56.81,0.2255},
  {58.27,0.21},
  {59.76,0.1956},
  {61.3,0.1821},
  {62.87,0.1696},
  {64.48,0.1579},
  {66.14,0.147},
  {67.84,0.1369},
  {69.58,0.1275},
  {71.37,0.1187},
  {73.2,0.1105},
  {75.08,0.1029},
  {77.01,0.09581},
  {78.98,0.0892},
  {81.01,0.08305},
  {83.09,0.07732},
  {85.23,0.07199},
  {87.41,0.06702},
  {89.66,0.06239},
  {91.96,0.05808},
  {94.32,0.05407},
  {96.75,0.05034},
  {99.23,0.04686},
  {101.8,0.04362},
  {104.4,0.04061},
  {107.1,0.0378},
  {109.8,0.03519},
  {112.6,0.03276},
  {115.5,0.03049},
  {118.5,0.02839},
  {121.5,0.02642},
  {124.7,0.0246},
  {127.9,0.0229},
  {131.1,0.02132},
  {134.5,0.01984},
  {138.,0.01847},
  {141.5,0.0172},
  {145.1,0.01601},
  {148.9,0.0149},
  {152.7,0.01388},
  {156.6,0.01292},
  {160.6,0.01203},
  {164.8,0.0112},
  {169.,0.01043},
  {173.3,0.009707},
  {177.8,0.009038},
  {182.3,0.008415},
  {187.,0.007836},
  {191.8,0.007297},
  {196.8,0.006795},
  {201.8,0.006328},
  {207.,0.005893},
  {212.3,0.005488},
  {217.8,0.005111},
  {223.4,0.004761},
  {229.1,0.004434},
  {235.,0.00413},
  {241.,0.003847},
  {247.2,0.003584},
  {253.5,0.003339},
  {260.1,0.00311},
  {266.7,0.002898},
  {273.6,0.0027},
  {280.6,0.002516},
  {287.8,0.002344},
  {295.2,0.002184},
  {302.8,0.002035},
  {310.6,0.001897},
  {318.5,0.001768},
  {326.7,0.001648},
  {335.1,0.001536},
  {343.7,0.001431},
  {352.5,0.001334},
  {361.6,0.001244},
  {370.9,0.00116},
  {380.4,0.001081},
  {390.2,0.001008},
  {400.2,0.0009399},
  {410.4,0.0008765},
  {421.,0.0008173},
  {431.8,0.0007622},
  {442.9,0.0007109},
  {454.3,0.000663},
  {465.9,0.0006184},
  {477.9,0.0005768},
  {490.2,0.0005381},
  {502.7,0.000502},
  {515.7,0.0004683},
  {528.9,0.0004369},
  {542.5,0.0004077},
  {556.4,0.0003804},
  {570.7,0.000355},
  {585.3,0.0003313},
  {600.4,0.0003092},
  {615.8,0.0002885},
  {631.6,0.0002693},
  {647.8,0.0002514},
  {664.5,0.0002347},
  {681.5,0.0002191},
  {699.,0.0002045},
  {717.,0.0001909},
  {735.4,0.0001783},
  {754.3,0.0001665},
  {773.6,0.0001554},
  {793.5,0.0001451},
  {813.9,0.0001355},
  {834.8,0.0001266},
  {856.2,0.0001182},
  {878.2,0.0001104},
  {900.7,0.0001032},
  {923.9,0.00009635},
  {947.6,0.00009001},
  {971.9,0.00008409},
  {996.9,0.00007856},
  {1022.,0.0000734},
  {1049.,0.00006858},
  {1076.,0.00006408},
  {1103.,0.00005988},
  {1132.,0.00005596},
  {1161.,0.0000523},
  {1190.,0.00004888},
  {1221.,0.00004568},
  {1252.,0.0000427},
  {1285.,0.00003991},
  {1318.,0.00003731},
  {1351.,0.00003488},
  {1386.,0.00003261},
  {1422.,0.0000305},
  {1458.,0.00002851},
  {1496.,0.00002667},
  {1534.,0.00002494},
  {1573.,0.00002332},
  {1614.,0.00002181},
  {1655.,0.0000204},
  {1698.,0.00001909},
  {1741.,0.00001786},
  {1786.,0.00001671},
  {1832.,0.00001563},
  {1879.,0.00001463},
  {1927.,0.00001369},
  {1977.,0.00001281},
  {2027.,0.00001199},
  {2080.,0.00001122},
  {2133.,0.0000105},
  {2188.,9.829e-6},
  {2244.,9.201e-6},
  {2301.,8.614e-6},
  {2361.,8.065e-6},
  {2421.,7.552e-6},
  {2483.,7.071e-6},
  {2547.,6.622e-6},
  {2613.,6.201e-6},
  {2680.,5.808e-6},
  {2748.,5.44e-6},
  {2819.,5.095e-6},
  {2891.,4.773e-6},
  {2966.,4.471e-6},
  {3042.,4.189e-6},
  {3120.,3.924e-6},
  {3200.,3.677e-6},
  {3282.,3.445e-6},
  {3366.,3.228e-6},
  {3453.,3.025e-6},
  {3542.,2.835e-6},
  {3632.,2.656e-6},
  {3726.,2.489e-6},
  {3821.,2.333e-6},
  {3920.,2.186e-6},
  {4020.,2.049e-6},
  {4123.,1.92e-6},
  {4229.,1.799e-6},
  {4338.,1.686e-6},
  {4449.,1.58e-6},
  {4564.,1.48e-6},
  {4681.,1.387e-6},
  {4801.,1.3e-6},
  {4924.,1.218e-6},
  {5051.,1.141e-6},
  {5180.,1.069e-6},
  {5313.,1.001e-6},
  {5450.,9.376e-7},
  {5590.,8.781e-7},
  {5733.,8.224e-7},
  {5880.,7.702e-7},
  {6031.,7.212e-7},
  {6186.,6.753e-7},
  {6345.,6.323e-7},
  {6508.,5.919e-7},
  {6675.,5.541e-7},
  {6847.,5.186e-7},
  {7022.,4.854e-7},
  {7203.,4.543e-7},
  {7388.,4.251e-7},
  {7577.,3.977e-7},
  {7772.,3.721e-7},
  {7972.,3.481e-7},
  {8176.,3.256e-7},
  {8386.,3.045e-7},
  {8602.,2.848e-7},
  {8822.,2.663e-7},
  {9049.,2.49e-7},
  {9281.,2.328e-7},
  {9520.,2.176e-7},
  {9764.,2.034e-7},
  {10010.,1.901e-7},
  {10270.,1.776e-7},
  {10540.,1.66e-7},
  {10810.,1.551e-7},
  {11080.,1.449e-7},
  {11370.,1.353e-7},
  {11660.,1.264e-7},
  {11960.,1.18e-7},
  {12270.,1.102e-7},
  {12580.,1.029e-7},
  {12900.,9.61e-8},
  {13240.,8.973e-8},
  {13580.,8.377e-8},
  {13920.,7.821e-8},
  {14280.,7.301e-8},
  {14650.,6.815e-8},
  {15030.,6.362e-8},
  {15410.,5.938e-8},
  {15810.,5.543e-8},
  {16210.,5.173e-8},
  {16630.,4.828e-8},
  {17060.,4.506e-8},
  {17490.,4.206e-8},
  {17940.,3.925e-8},
  {18400.,3.663e-8},
  {18880.,3.419e-8},
  {19360.,3.19e-8},
  {19860.,2.977e-8},
  {20370.,2.779e-8},
  {20890.,2.593e-8},
  {21430.,2.42e-8},
  {21980.,2.259e-8},
  {22540.,2.108e-8},
  {23120.,1.967e-8},
  {23710.,1.836e-8},
  {24320.,1.714e-8},
  {24950.,1.599e-8},
  {25590.,1.493e-8},
  {26250.,1.393e-8},
  {26920.,1.301e-8},
  {27610.,1.214e-8},
  {28320.,1.133e-8},
  {29050.,1.058e-8},
  {29790.,9.875e-9},
  {30560.,9.218e-9},
  {31340.,8.606e-9},
  {32150.,8.035e-9},
  {32970.,7.502e-9},
  {33820.,7.004e-9},
  {34690.,6.54e-9},
  {35580.,6.107e-9},
  {36490.,5.703e-9},
  {37430.,5.326e-9},
  {38390.,4.974e-9},
  {39380.,4.645e-9},
  {40390.,4.339e-9},
  {41420.,4.052e-9},
  {42490.,3.785e-9},
  {43580.,3.536e-9},
  {44700.,3.303e-9},
  {45850.,3.086e-9},
  {47020.,2.883e-9},
  {48230.,2.694e-9},
  {49470.,2.517e-9},
  {50740.,2.352e-9},
  {52040.,2.198e-9},
  {53380.,2.054e-9},
  {54750.,1.92e-9},
  {56160.,1.794e-9},
  {57600.,1.677e-9},
  {59080.,1.568e-9},
  {60590.,1.466e-9},
  {62150.,1.37e-9},
  {63750.,1.281e-9},
  {65380.,1.198e-9},
  {67060.,1.12e-9},
  {68780.,1.047e-9},
  {70550.,9.793e-10},
  {72360.,9.159e-10},
  {74220.,8.566e-10},
  {76120.,8.012e-10},
  {78080.,7.494e-10},
  {80080.,7.01e-10},
  {82140.,6.557e-10},
  {84250.,6.135e-10},
  {86410.,5.739e-10},
  {88630.,5.37e-10},
  {90910.,5.025e-10},
  {93240.,4.702e-10},
  {95640.,4.4e-10},
  {98090.,4.117e-10},
  {100600.,3.853e-10},
  {103200.,3.606e-10},
  {105800.,3.375e-10},
  {108600.,3.159e-10},
  {111400.,2.957e-10},
  {114200.,2.768e-10},
  {117100.,2.592e-10},
  {120200.,2.426e-10},
  {123200.,2.271e-10},
  {126400.,2.126e-10},
  {129600.,1.991e-10},
  {133000.,1.864e-10},
  {136400.,1.745e-10},
  {139900.,1.634e-10},
  {143500.,1.53e-10},
  {147200.,1.432e-10},
  {150900.,1.341e-10},
  {154800.,1.255e-10},
  {158800.,1.175e-10},
  {162900.,1.101e-10},
  {167100.,1.03e-10},
  {171300.,9.647e-11},
  {175700.,9.033e-11},
  {180300.,8.457e-11},
  {184900.,7.918e-11},
  {189600.,7.413e-11},
  {194500.,6.94e-11},
  {199500.,6.498e-11},
  {204600.,6.083e-11},
  {209900.,5.695e-11},
  {215300.,5.331e-11},
  {220800.,4.991e-11},
  {226500.,4.672e-11},
  {232300.,4.374e-11},
  {238200.,4.094e-11},
  {244400.,3.832e-11},
  {250600.,3.587e-11},
  {257100.,3.357e-11},
  {263700.,3.143e-11},
  {270400.,2.941e-11},
  {277400.,2.753e-11},
  {284500.,2.576e-11},
  {291800.,2.411e-11},
  {299300.,2.256e-11},
  {307000.,2.111e-11},
  {314900.,1.976e-11},
  {323000.,1.849e-11},
  {331300.,1.73e-11},
  {339800.,1.619e-11},
  {348500.,1.514e-11},
  {357400.,1.417e-11},
  {366600.,1.326e-11},
  {376000.,1.24e-11},
  {385700.,1.16e-11},
  {395600.,1.085e-11},
  {405700.,1.015e-11},
  {416200.,9.494e-12},
  {426800.,8.88e-12},
  {437800.,8.306e-12},
  {449100.,7.768e-12},
  {460600.,7.265e-12},
  {472400.,6.794e-12},
  {484500.,6.353e-12},
  {497000.,5.94e-12},
  {509700.,5.555e-12},
  {522800.,5.194e-12},
  {536300.,4.856e-12},
  {550000.,4.54e-12},
  {564200.,4.244e-12},
  {578600.,3.968e-12},
  {593500.,3.709e-12},
  {608700.,3.467e-12},
  {624400.,3.24e-12},
  {640400.,3.029e-12},
  {656800.,2.831e-12},
  {673700.,2.646e-12},
  {691000.,2.472e-12},
  {708800.,2.31e-12},
  {727000.,2.159e-12},
  {745600.,2.017e-12},
  {764800.,1.885e-12},
  {784400.,1.761e-12},
  {804500.,1.646e-12},
  {825200.,1.537e-12},
  {846400.,1.436e-12},
  {868100.,1.342e-12},
  {890400.,1.253e-12},
  {913300.,1.171e-12},
  {936700.,1.093e-12},
  {960800.,1.021e-12},
  {985500.,9.537e-13},
  {1.011e6,8.907e-13},
  {1.037e6,8.318e-13},
  {1.063e6,7.767e-13},
  {1.091e6,7.253e-13},
  {1.119e6,6.771e-13},
  {1.147e6,6.322e-13},
  {1.177e6,5.901e-13},
  {1.207e6,5.508e-13},
  {1.238e6,5.141e-13},
  {1.27e6,4.797e-13},
  {1.302e6,4.476e-13},
  {1.336e6,4.176e-13},
  {1.37e6,3.896e-13},
  {1.405e6,3.633e-13},
  {1.441e6,3.388e-13},
  {1.478e6,3.159e-13},
  {1.516e6,2.945e-13},
  {1.555e6,2.745e-13},
  {1.595e6,2.558e-13},
  {1.636e6,2.384e-13},
  {1.678e6,2.221e-13},
  {1.721e6,2.068e-13},
  {1.766e6,1.926e-13},
  {1.811e6,1.793e-13},
  {1.857e6,1.669e-13},
  {1.905e6,1.553e-13},
  {1.954e6,1.445e-13},
  {2.004e6,1.344e-13},
  {2.056e6,1.25e-13},
  {2.108e6,1.162e-13},
  {2.163e6,1.08e-13},
  {2.218e6,1.004e-13},
  {2.275e6,9.323e-14},
  {2.334e6,8.658e-14},
  {2.393e6,8.039e-14},
  {2.455e6,7.462e-14},
  {2.518e6,6.924e-14},
  {2.583e6,6.423e-14},
  {2.649e6,5.957e-14},
  {2.717e6,5.522e-14},
  {2.787e6,5.118e-14},
  {2.858e6,4.741e-14},
  {2.932e6,4.391e-14},
  {3.007e6,4.065e-14},
  {3.084e6,3.763e-14},
  {3.163e6,3.481e-14},
  {3.245e6,3.219e-14},
  {3.328e6,2.976e-14},
  {3.413e6,2.75e-14},
  {3.501e6,2.541e-14},
  {3.591e6,2.346e-14},
  {3.683e6,2.166e-14},
  {3.778e6,1.999e-14},
  {3.875e6,1.844e-14},
  {3.974e6,1.701e-14},
  {4.076e6,1.568e-14},
  {4.181e6,1.445e-14},
  {4.288e6,1.332e-14},
  {4.398e6,1.227e-14},
  {4.511e6,1.13e-14},
  {4.627e6,1.041e-14},
  {4.746e6,9.58e-15},
  {4.868e6,8.817e-15},
  {4.993e6,8.113e-15},
  {5.121e6,7.463e-15},
  {5.252e6,6.864e-15},
  {5.387e6,6.312e-15},
  {5.526e6,5.803e-15},
  {5.668e6,5.334e-15},
  {5.813e6,4.903e-15},
  {5.962e6,4.505e-15},
  {6.115e6,4.139e-15},
  {6.273e6,3.803e-15},
  {6.434e6,3.493e-15},
  {6.599e6,3.208e-15},
  {6.768e6,2.946e-15},
  {6.942e6,2.706e-15},
  {7.12e6,2.485e-15},
  {7.303e6,2.281e-15},
  {7.491e6,2.095e-15},
  {7.683e6,1.923e-15},
  {7.88e6,1.766e-15},
  {8.083e6,1.621e-15},
  {8.29e6,1.489e-15},
  {8.503e6,1.367e-15},
  {8.721e6,1.255e-15},
  {8.945e6,1.153e-15},
  {9.175e6,1.059e-15},
  {9.411e6,9.725e-16},
  {9.652e6,8.934e-16},
  {9.9e6,8.209e-16},
  {1.015e7,7.545e-16},
  {1.042e7,6.935e-16},
  {1.068e7,6.377e-16},
  {1.096e7,5.864e-16},
  {1.124e7,5.394e-16},
  {1.153e7,4.962e-16},
  {1.182e7,4.566e-16},
  {1.213e7,4.202e-16},
  {1.244e7,3.868e-16},
  {1.276e7,3.561e-16},
  {1.308e7,3.279e-16},
  {1.342e7,3.02e-16},
  {1.377e7,2.782e-16},
  {1.412e7,2.563e-16},
  {1.448e7,2.362e-16},
  {1.485e7,2.177e-16},
  {1.523e7,2.007e-16},
  {1.563e7,1.85e-16},
  {1.603e7,1.706e-16},
  {1.644e7,1.573e-16},
  {1.686e7,1.451e-16},
  {1.729e7,1.339e-16},
  {1.774e7,1.235e-16},
  {1.819e7,1.14e-16},
  {1.866e7,1.052e-16},
  {1.914e7,9.708e-17},
  {1.963e7,8.961e-17},
  {2.013e7,8.272e-17},
  {2.065e7,7.638e-17},
  {2.118e7,7.052e-17},
  {2.173e7,6.512e-17},
  {2.228e7,6.014e-17},
  {2.286e7,5.555e-17},
  {2.344e7,5.131e-17},
  {2.405e7,4.739e-17},
  {2.466e7,4.378e-17},
  {2.53e7,4.044e-17},
  {2.595e7,3.736e-17},
  {2.661e7,3.452e-17},
  {2.729e7,3.189e-17},
  {2.8e7,2.947e-17},
  {2.871e7,2.723e-17},
  {2.945e7,2.515e-17},
  {3.021e7,2.324e-17},
  {3.098e7,2.147e-17},
  {3.178e7,1.984e-17},
  {3.26e7,1.833e-17},
  {3.343e7,1.693e-17},
  {3.429e7,1.564e-17},
  {3.517e7,1.445e-17},
  {3.607e7,1.335e-17},
  {3.7e7,1.234e-17},
  {3.795e7,1.14e-17},
  {3.893e7,1.053e-17},
  {3.993e7,9.729e-18},
  {4.095e7,8.99e-18},
  {4.2e7,8.307e-18},
  {4.308e7,7.677e-18},
  {4.419e7,7.095e-18},
  {4.532e7,6.558e-18},
  {4.648e7,6.062e-18},
  {4.768e7,5.604e-18},
  {4.89e7,5.181e-18},
  {5.016e7,4.791e-18},
  {5.145e7,4.43e-18},
  {5.277e7,4.098e-18},
  {5.412e7,3.791e-18},
  {5.551e7,3.507e-18},
  {5.694e7,3.245e-18},
  {5.84e7,3.003e-18},
  {5.99e7,2.78e-18},
  {6.144e7,2.574e-18},
  {6.301e7,2.384e-18},
  {6.463e7,2.208e-18},
  {6.629e7,2.045e-18},
  {6.799e7,1.895e-18},
  {6.974e7,1.757e-18},
  {7.153e7,1.629e-18},
  {7.337e7,1.51e-18},
  {7.525e7,1.401e-18},
  {7.718e7,1.3e-18},
  {7.917e7,1.206e-18},
  {8.12e7,1.12e-18},
  {8.328e7,1.04e-18},
  {8.542e7,9.66e-19},
  {8.762e7,8.976e-19},
  {8.987e7,8.343e-19},
  {9.217e7,7.757e-19},
  {9.454e7,7.214e-19},
  {9.697e7,6.711e-19},
  {9.946e7,6.246e-19},
  {1.02e8,5.815e-19},
  {1.046e8,5.415e-19},
  {1.073e8,5.044e-19},
  {1.101e8,4.701e-19},
  {1.129e8,4.381e-19},
  {1.158e8,4.085e-19},
  {1.188e8,3.809e-19},
  {1.218e8,3.553e-19},
  {1.25e8,3.315e-19},
  {1.282e8,3.094e-19},
  {1.315e8,2.888e-19},
  {1.348e8,2.696e-19},
  {1.383e8,2.517e-19},
  {1.418e8,2.35e-19},
  {1.455e8,2.195e-19},
  {1.492e8,2.051e-19},
  {1.53e8,1.916e-19},
  {1.57e8,1.79e-19},
  {1.61e8,1.672e-19},
  {1.651e8,1.563e-19},
  {1.694e8,1.461e-19},
  {1.737e8,1.365e-19},
  {1.782e8,1.276e-19},
  {1.828e8,1.193e-19},
  {1.875e8,1.115e-19},
  {1.923e8,1.042e-19},
  {1.972e8,9.741e-20},
  {2.023e8,9.106e-20},
  {2.075e8,8.512e-20},
  {2.128e8,7.956e-20},
  {2.183e8,7.437e-20},
  {2.239e8,6.952e-20},
  {2.296e8,6.498e-20},
  {2.355e8,6.073e-20},
  {2.416e8,5.676e-20},
  {2.478e8,5.305e-20},
  {2.541e8,4.957e-20},
  {2.607e8,4.632e-20},
  {2.673e8,4.328e-20},
  {2.742e8,4.044e-20},
  {2.813e8,3.778e-20},
  {2.885e8,3.529e-20},
  {2.959e8,3.296e-20},
  {3.035e8,3.078e-20},
  {3.113e8,2.875e-20},
  {3.193e8,2.684e-20},
  {3.275e8,2.506e-20},
  {3.359e8,2.34e-20},
  {3.445e8,2.184e-20},
  {3.533e8,2.038e-20},
  {3.624e8,1.902e-20},
  {3.717e8,1.775e-20},
  {3.813e8,1.657e-20},
  {3.911e8,1.546e-20},
  {4.011e8,1.442e-20},
  {4.114e8,1.345e-20},
  {4.22e8,1.255e-20},
  {4.328e8,1.171e-20},
  {4.439e8,1.092e-20},
  {4.553e8,1.019e-20},
  {4.67e8,9.5e-21},
  {4.79e8,8.86e-21},
  {4.913e8,8.263e-21},
  {5.039e8,7.706e-21},
  {5.168e8,7.186e-21},
  {5.301e8,6.701e-21},
  {5.437e8,6.249e-21},
  {5.577e8,5.827e-21},
  {5.72e8,5.433e-21},
  {5.867e8,5.066e-21},
  {6.018e8,4.724e-21},
  {6.172e8,4.404e-21},
  {6.331e8,4.107e-21},
  {6.493e8,3.829e-21},
  {6.66e8,3.57e-21},
  {6.831e8,3.329e-21},
  {7.006e8,3.104e-21},
  {7.186e8,2.894e-21},
  {7.371e8,2.698e-21},
  {7.56e8,2.516e-21},
  {7.754e8,2.346e-21},
  {7.953e8,2.188e-21},
  {8.157e8,2.04e-21},
  {8.367e8,1.902e-21},
  {8.582e8,1.774e-21},
  {8.802e8,1.654e-21},
  {9.028e8,1.543e-21},
  {9.26e8,1.439e-21},
  {9.498e8,1.342e-21},
  {9.742e8,1.251e-21},
  {9.992e8,1.167e-21},
  {1.025e9,1.088e-21},
  {1.051e9,1.015e-21},
  {1.078e9,9.469e-22},
  {1.106e9,8.831e-22},
  {1.134e9,8.236e-22},
  {1.163e9,7.68e-22},
  {1.193e9,7.161e-22},
  {1.224e9,6.676e-22},
  {1.255e9,6.223e-22},
  {1.288e9,5.8e-22},
  {1.321e9,5.404e-22},
  {1.354e9,5.034e-22},
  {1.389e9,4.688e-22},
  {1.425e9,4.365e-22},
  {1.462e9,4.063e-22},
  {1.499e9,3.781e-22},
  {1.538e9,3.517e-22},
  {1.577e9,3.27e-22},
  {1.618e9,3.04e-22},
  {1.659e9,2.825e-22},
  {1.702e9,2.624e-22},
  {1.745e9,2.436e-22},
  {1.79e9,2.26e-22},
  {1.836e9,2.097e-22},
  {1.883e9,1.944e-22},
  {1.932e9,1.801e-22},
  {1.981e9,1.668e-22},
  {2.032e9,1.544e-22},
  {2.084e9,1.428e-22},
  {2.138e9,1.32e-22},
  {2.193e9,1.22e-22},
  {2.249e9,1.126e-22},
  {2.307e9,1.039e-22},
  {2.366e9,9.578e-23},
  {2.427e9,8.824e-23},
  {2.489e9,8.121e-23},
  {2.553e9,7.469e-23},
  {2.619e9,6.862e-23},
  {2.686e9,6.299e-23},
  {2.755e9,5.776e-23},
  {2.825e9,5.291e-23},
  {2.898e9,4.842e-23},
  {2.972e9,4.425e-23},
  {3.049e9,4.039e-23},
  {3.127e9,3.682e-23},
  {3.207e9,3.351e-23},
  {3.29e9,3.046e-23},
  {3.374e9,2.765e-23},
  {3.461e9,2.506e-23},
  {3.55e9,2.268e-23},
  {3.641e9,2.05e-23},
  {3.734e9,1.85e-23},
  {3.83e9,1.668e-23},
  {3.929e9,1.502e-23},
  {4.029e9,1.35e-23},
  {4.133e9,1.213e-23},
  {4.239e9,1.088e-23},
  {4.348e9,9.752e-24},
  {4.46e9,8.732e-24},
  {4.574e9,7.811e-24},
  {4.692e9,6.982e-24},
  {4.812e9,6.237e-24},
  {4.936e9,5.568e-24},
  {5.062e9,4.97e-24},
  {5.192e9,4.435e-24},
  {5.326e9,3.958e-24},
  {5.462e9,3.534e-24},
  {5.603e9,3.158e-24},
  {5.747e9,2.824e-24},
  {5.894e9,2.528e-24},
  {6.045e9,2.267e-24},
  {6.201e9,2.035e-24},
  {6.36e9,1.829e-24},
  {6.523e9,1.647e-24},
  {6.691e9,1.486e-24},
  {6.862e9,1.343e-24},
  {7.039e9,1.215e-24},
  {7.219e9,1.103e-24},
  {7.405e9,1.002e-24},
  {7.595e9,9.128e-25},
  {7.79e9,8.332e-25},
  {7.99e9,7.622e-25},
  {8.195e9,6.987e-25},
  {8.406e9,6.42e-25},
  {8.621e9,5.91e-25},
  {8.843e9,5.453e-25},
  {9.07e9,5.042e-25},
  {9.303e9,4.671e-25},
  {9.542e9,4.335e-25},
  {9.787e9,4.031e-25},
  {1.004e10,3.755e-25},
  {1.03e10,3.503e-25},
  {1.056e10,3.273e-25},
  {1.083e10,3.061e-25},
  {1.111e10,2.866e-25},
  {1.139e10,2.685e-25},
  {1.169e10,2.516e-25},
  {1.199e10,2.359e-25},
  {1.23e10,2.211e-25},
  {1.261e10,2.072e-25},
  {1.293e10,1.942e-25},
  {1.327e10,1.818e-25},
  {1.361e10,1.701e-25},
  {1.396e10,1.59e-25},
  {1.432e10,1.485e-25},
  {1.468e10,1.386e-25},
  {1.506e10,1.291e-25},
  {1.545e10,1.2e-25},
  {1.584e10,1.115e-25},
  {1.625e10,1.033e-25},
  {1.667e10,9.553e-26},
  {1.71e10,8.816e-26},
  {1.753e10,8.115e-26},
  {1.798e10,7.45e-26},
  {1.845e10,6.82e-26},
  {1.892e10,6.227e-26},
  {1.941e10,5.67e-26},
  {1.99e10,5.149e-26},
  {2.042e10,4.664e-26},
  {2.094e10,4.214e-26},
  {2.148e10,3.797e-26},
  {2.203e10,3.414e-26},
  {2.259e10,3.061e-26},
  {2.317e10,2.737e-26},
  {2.377e10,2.442e-26},
  {2.438e10,2.173e-26},
  {2.501e10,1.928e-26},
  {2.565e10,1.707e-26},
  {2.631e10,1.507e-26},
  {2.698e10,1.327e-26},
  {2.767e10,1.166e-26},
  {2.839e10,1.022e-26},
  {2.911e10,8.93e-27},
  {2.986e10,7.788e-27},
  {3.063e10,6.777e-27},
  {3.142e10,5.886e-27},
  {3.222e10,5.105e-27},
  {3.305e10,4.42e-27},
  {3.39e10,3.821e-27},
  {3.477e10,3.298e-27},
  {3.566e10,2.842e-27},
  {3.658e10,2.444e-27},
  {3.752e10,2.098e-27},
  {3.848e10,1.797e-27},
  {3.947e10,1.537e-27},
  {4.048e10,1.311e-27},
  {4.152e10,1.115e-27},
  {4.259e10,9.468e-28},
  {4.368e10,8.016e-28},
  {4.48e10,6.767e-28},
  {4.595e10,5.696e-28},
  {4.713e10,4.779e-28},
  {4.834e10,3.996e-28},
  {4.958e10,3.329e-28},
  {5.086e10,2.763e-28},
  {5.216e10,2.283e-28},
  {5.35e10,1.878e-28},
  {5.488e10,1.537e-28},
  {5.629e10,1.252e-28},
  {5.773e10,1.013e-28},
  {5.921e10,8.149e-29},
  {6.073e10,6.508e-29},
  {6.229e10,5.157e-29},
  {6.389e10,4.052e-29},
  {6.553e10,3.153e-29},
  {6.722e10,2.427e-29},
  {6.894e10,1.846e-29},
  {7.071e10,1.384e-29},
  {7.253e10,1.021e-29},
  {7.439e10,7.395e-30},
  {7.63e10,5.238e-30},
  {7.826e10,3.613e-30},
  {8.027e10,2.413e-30},
  {8.233e10,1.548e-30},
  {8.444e10,9.437e-31},
  {8.661e10,5.372e-31},
  {8.884e10,2.781e-31},
  {9.112e10,1.251e-31},
  {9.346e10,4.461e-32},
  {9.586e10,1.011e-32},
  {9.832e10,6.029e-34},
  {1.008e11,0.},
  {1.034e11,0.},
  {1.061e11,0.},
  {1.088e11,0.},
  {1.116e11,0.},
  {1.145e11,0.},
  {1.174e11,0.},
  {1.204e11,0.},
  {1.235e11,0.},
  {1.267e11,0.},
  {1.299e11,0.},
  {1.333e11,0.},
  {1.367e11,0.},
  {1.402e11,0.},
  {1.438e11,0.},
  {1.475e11,0.},
  {1.513e11,0.},
  {1.552e11,0.},
  {1.592e11,0.},
  {1.633e11,0.},
  {1.674e11,0.},
  {1.717e11,0.},
  {1.762e11,0.},
  {1.807e11,0.},
  {1.853e11,0.},
  {1.901e11,0.},
  {1.95e11,0.},
  {2.e11,0.},
  {2.051e11,0.},
  {2.104e11,0.},
  {2.158e11,0.},
  {2.213e11,0.},
  {2.27e11,0.},
  {2.328e11,0.},
  {2.388e11,0.},
  {2.449e11,0.},
  {2.512e11,0.},
  {2.577e11,0.},
  {2.643e11,0.},
  {2.711e11,0.},
  {2.78e11,0.},
  {2.852e11,0.},
  {2.925e11,0.},
  {3.e11,0.}
};

double phi_GSF(double Ep) { // `global spline fit' Dembinski
  for (int i=0;i<THOUSAND-1;i++) {
    if ((GSF_data[i].Ep<=Ep)&&(GSF_data[i+1].Ep>=Ep)) {
      double slope = ( Ep - GSF_data[i].Ep )/( GSF_data[i+1].Ep - GSF_data[i].Ep );
      return GSF_data[i+1].phi*slope + GSF_data[i].phi*(1.-slope);
    }
  }
  return 1e-34;
}
